<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Project Playcare - Stable FPS</title>
<style>
body { margin:0; overflow:hidden; background:black; }
#overlay {
position:absolute;
width:100%;
height:100%;
background:black;
color:white;
display:flex;
align-items:center;
justify-content:center;
font-size:40px;
cursor:pointer;
z-index:10;
}
#ui {
position:absolute;
top:10px;
left:10px;
color:white;
font-family:monospace;
font-size:14px;
display:none;
}
</style>
</head>
<body>

<div id="overlay">Click To Enter</div>
<div id="ui">WASD Move | Mouse Look</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>

<script>

/* ================= BASIC THREE SETUP ================= */

const scene = new THREE.Scene();
scene.background = new THREE.Color(0x111111);

const camera = new THREE.PerspectiveCamera(
75,
window.innerWidth/window.innerHeight,
0.1,
1000
);

camera.position.set(0,5,20);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

/* ================= LIGHTING ================= */

const ambient = new THREE.AmbientLight(0xffffff, 0.4);
scene.add(ambient);

const light = new THREE.DirectionalLight(0xffffff, 0.8);
light.position.set(10,20,10);
scene.add(light);

/* ================= ROOM ================= */

function wall(x,y,z,w,h,d,color=0x333333){
const mesh = new THREE.Mesh(
new THREE.BoxGeometry(w,h,d),
new THREE.MeshStandardMaterial({color})
);
mesh.position.set(x,y,z);
scene.add(mesh);
}

let size = 100;

// floor
wall(0,-1,0,size,2,size,0x222222);

// walls
wall(0,25,-size/2,size,50,2);
wall(0,25,size/2,size,50,2);
wall(-size/2,25,0,2,50,size);
wall(size/2,25,0,2,50,size);

// door
const door = new THREE.Mesh(
new THREE.BoxGeometry(10,20,2),
new THREE.MeshStandardMaterial({color:0x550000})
);
door.position.set(0,10,-40);
scene.add(door);

/* ================= POINTER LOCK (MANUAL) ================= */

const overlay = document.getElementById("overlay");

overlay.addEventListener("click", () => {
document.body.requestPointerLock();
});

document.addEventListener("pointerlockchange", () => {
if (document.pointerLockElement === document.body) {
overlay.style.display = "none";
document.getElementById("ui").style.display = "block";
} else {
overlay.style.display = "flex";
document.getElementById("ui").style.display = "none";
}
});

/* ================= MOUSE LOOK ================= */

let yaw = 0;
let pitch = 0;

document.addEventListener("mousemove", (event) => {
if (document.pointerLockElement === document.body) {
yaw -= event.movementX * 0.002;
pitch -= event.movementY * 0.002;

pitch = Math.max(-Math.PI/2, Math.min(Math.PI/2, pitch));

camera.rotation.order = "YXZ";
camera.rotation.y = yaw;
camera.rotation.x = pitch;
}
});

/* ================= MOVEMENT ================= */

let move = {forward:false, back:false, left:false, right:false};
let velocity = new THREE.Vector3();
let direction = new THREE.Vector3();

document.addEventListener("keydown", e=>{
if(e.code==="KeyW") move.forward=true;
if(e.code==="KeyS") move.back=true;
if(e.code==="KeyA") move.left=true;
if(e.code==="KeyD") move.right=true;
});

document.addEventListener("keyup", e=>{
if(e.code==="KeyW") move.forward=false;
if(e.code==="KeyS") move.back=false;
if(e.code==="KeyA") move.left=false;
if(e.code==="KeyD") move.right=false;
});

function animate(){
requestAnimationFrame(animate);

direction.set(0,0,0);

if(move.forward) direction.z -= 1;
if(move.back) direction.z += 1;
if(move.left) direction.x -= 1;
if(move.right) direction.x += 1;

direction.normalize();

const speed = 0.3;

// move relative to camera direction
const forward = new THREE.Vector3();
camera.getWorldDirection(forward);
forward.y = 0;
forward.normalize();

const right = new THREE.Vector3();
right.crossVectors(forward, new THREE.Vector3(0,1,0)).normalize();

camera.position.add(forward.multiplyScalar(direction.z * speed));
camera.position.add(right.multiplyScalar(direction.x * speed));

renderer.render(scene, camera);
}

animate();

</script>

</body>
</html>
