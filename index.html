<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>FPS Test Stable</title>
<style>
body { margin:0; overflow:hidden; background:black; }

canvas {
display:block;
}

#overlay {
position:absolute;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.85);
color:white;
display:flex;
align-items:center;
justify-content:center;
font-size:40px;
cursor:pointer;
z-index:100;
}
</style>
</head>
<body>

<div id="overlay">Click To Enter</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>

<script>

console.log("THREE exists:", typeof THREE);

const scene = new THREE.Scene();
scene.background = new THREE.Color(0x222244);

const camera = new THREE.PerspectiveCamera(
75,
window.innerWidth/window.innerHeight,
0.1,
1000
);

camera.position.set(0,5,15);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

/* LIGHT */
const light = new THREE.DirectionalLight(0xffffff,1);
light.position.set(5,10,5);
scene.add(light);

/* FLOOR */
const floor = new THREE.Mesh(
new THREE.BoxGeometry(50,1,50),
new THREE.MeshStandardMaterial({color:0x444444})
);
floor.position.y = -1;
scene.add(floor);

/* CUBE */
const cube = new THREE.Mesh(
new THREE.BoxGeometry(3,3,3),
new THREE.MeshStandardMaterial({color:0xff0000})
);
scene.add(cube);

/* OVERLAY */
const overlay = document.getElementById("overlay");

overlay.addEventListener("click", () => {
renderer.domElement.requestPointerLock();
});

/* POINTER LOCK EVENTS */
document.addEventListener("pointerlockchange", () => {
if (document.pointerLockElement === renderer.domElement) {
overlay.style.display = "none";
} else {
overlay.style.display = "flex";
}
});

/* MOUSE LOOK */
let yaw = 0;
let pitch = 0;

document.addEventListener("mousemove", (event) => {
if (document.pointerLockElement === renderer.domElement) {

yaw -= event.movementX * 0.002;
pitch -= event.movementY * 0.002;

pitch = Math.max(-Math.PI/2, Math.min(Math.PI/2, pitch));

camera.rotation.order = "YXZ";
camera.rotation.y = yaw;
camera.rotation.x = pitch;
}
});

/* MOVEMENT */
let keys = {};

document.addEventListener("keydown", e => keys[e.code] = true);
document.addEventListener("keyup", e => keys[e.code] = false);

function animate(){
requestAnimationFrame(animate);

const speed = 0.2;

if(keys["KeyW"]) camera.position.z -= speed;
if(keys["KeyS"]) camera.position.z += speed;
if(keys["KeyA"]) camera.position.x -= speed;
if(keys["KeyD"]) camera.position.x += speed;

cube.rotation.y += 0.01;

renderer.render(scene, camera);
}

animate();

/* RESIZE FIX */
window.addEventListener("resize", () => {
camera.aspect = window.innerWidth/window.innerHeight;
camera.updateProjectionMatrix();
renderer.setSize(window.innerWidth, window.innerHeight);
});

</script>

</body>
</html>
